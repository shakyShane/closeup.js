!function(t){"use strict";function e(t,e,o){return(e-t)*o+t}function o(t,e,o){return(o-t)/(e-t)}function i(t){return this.x=t.x||0,this.y=t.y||0,this.width=t.width||0,this.height=t.height||0,this}var s=function(t){return this.opts={boundary:t.boundary||0,safeZone:t.safeZone||0},this.viewBox=new i(t.viewBox),this};s.prototype.mapTo=function(t){return this.subject=new i(t),this},s.prototype.map=function(t,o){var i=0,s=0,a=this.viewBox,n=this.subject,r={x:!1,y:!1,inHitArea:!1,inBoundary:!1};if(this.checkPosition(t,o)){var h=this.getRelativeOffset("x"),p=(n.width-a.width)/2,m=this.getRelativeOffset("y"),u=(n.height-a.height)/2;this.canLerp("x",t)?i=e(h+p,h-p,this.getNormValue("x",t)):(i=this.getBoundary("x",t),r.inBoundary=!0),this.canLerp("y",o)?s=e(m+u,m-u,this.getNormValue("y",o)):(s=this.getBoundary("y",o),r.inBoundary=!0),r.x=i,r.y=s,r.inHitArea=!0}return r},s.prototype.checkPosition=function(t,e){var o=this.opts.safeZone,i=this.viewBox,s=t>=i.x-o&&t<=i.x+i.width+o,a=e>=i.y-o&&e<=i.y+i.height+o;return s&&a},s.prototype.getBoundary=function(t,e){var o="width",i=this.viewBox,s=this.subject,a=this.opts.boundary;return"y"===t&&(o="height"),e<=i[t]+a?i[t]:e>=i[t]+i[o]-a?i[t]+i[o]-s[o]:!1},s.prototype.getRelativeOffset=function(t){var e="width",o=this.viewBox,i=this.subject;return"y"===t&&(e="height"),o[t]-(i[e]-o[e])/2},s.prototype.canLerp=function(t,e){var o="width",i=this.viewBox,s=this.opts.boundary;"y"===t&&(o="height");var a=i[t]+s,n=i[t]+i[o]-s;return e>a&&n>e},s.prototype.getNormValue=function(t,e){var i="width",s=this.viewBox,a=this.opts.boundary;"y"===t&&(i="height");var n=s[t]+a,r=s[t]+s[i]-a;return o(n,r,e)},"function"==typeof define&&define.amd?define(function(){return s}):"undefined"!=typeof module&&module.exports?module.exports=s:t.Norman=s}(window),function(t){"use strict";function e(t){this.x=t.getBoundingClientRect().left,this.y=t.getBoundingClientRect().top,this.width=t.width,this.height=t.height,this.$elem=t}var o={wrapper:["position: relative","overflow: hidden","display: inline-block"],baseImg:["display: block","z-index: 1"],zoomImg:["position: absolute","z-index: 2","opacity: 0","top: 0","left: 0","max-width: none!important"]},i={"no elements":"ERROR: The elements were not found"},s={hover:!0,zoomVisible:!1,hasZoomImage:!1,imageLoading:!1,baseImageLoading:!1,boundary:50,supports:{}},a=function(t,e,o){return this._addCallbacks(o)._handleArguments(arguments)._initElements(t,e)._setVars()._setEvents(this.$wrapper)._setMapping(this.$baseImage)};a.prototype._updateMapping=function(t){this.mapper.viewBox.width=t.width,this.mapper.viewBox.height=t.height},a.prototype._setMapping=function(t){return this.mapper=new Norman({viewBox:{height:t.clientHeight,width:t.clientWidth},boundary:this.vars.boundary}),this._cb("set mapping",this.mapper),this},a.prototype._setVars=function(){this.vars={};for(var t in s)this.vars[t]=s[t];for(var o in this.opts)this.vars[o]=this.opts[o];return this.baseImg=new e(this.$baseImage),this._setSupports(this.vars,this.$wrapper),this._cb("set vars",this.vars),this},a.prototype._setEvents=function(t){var e=this;return t.addEventListener("mousemove",function(t){if(!e.vars.imageLoading&&e.$zoomImage){e.vars.zoomVisible===!1&&e.showZoomed();var o=Math.abs(e.$baseImage.getBoundingClientRect().left-t.clientX),i=Math.abs(e.$baseImage.getBoundingClientRect().top-t.clientY);e._updateMousePosition(o,i),e._cb("mouse move",[o,i])}}),t.addEventListener("mouseenter",function(t){t.preventDefault(),e.vars.imageLoading||(e._cb("mouse enter",t),e.showZoomed())},!1),t.addEventListener("mouseleave",function(t){t.preventDefault(),e.vars.imageLoading||(e._cb("mouse leave",t),e.hideZoomed())},!1),this._cb("set events",this),this},a.prototype._updateMousePosition=function(t,e){var o=this.mapper.map(t,e);o.inHitArea&&this._updateElem(o.x,o.y)},a.prototype._onLoadCallback=function(e){var o=this,i=this.vars.supports;return function(){i.opacity||(o.$zoomImage.style.display="none"),o._imageLoaded(),t.setTimeout(function(){o.vars.imageLoading=!1,o._cb("zoom image loaded",o.$zoomImage),"function"==typeof e&&e.call(o,o.$zoomImage)},o.opts.loadDelay||0)}},a.prototype._imageLoaded=function(){var t=this.$zoomImage,o=this.zoomImg=new e(t),i=this.baseImg;o.maxX=-(t.width-i.width),o.maxY=-(t.height-i.height),this._updateElem(o.maxX/2,o.maxY/2),this.$zoomImage.hasTouchEvents||(t.addEventListener("touchstart",this._onTouchStart(this),!1),t.addEventListener("touchmove",this._onTouchMove(this),!1),this.$zoomImage.hasTouchEvents=!0),this.mapper.mapTo({height:t.height,width:t.width})},a.prototype._onTouchStart=function(t){var e=t;return function(t){e.vars.zoomVisible&&(t.preventDefault(),e.touchOffsetX=t.touches[0].pageX-e.$zoomImage.getBoundingClientRect().left+e.$baseImage.getBoundingClientRect().left,e.touchOffsetY=t.touches[0].pageY-e.$zoomImage.getBoundingClientRect().top+e.$baseImage.getBoundingClientRect().top)}},a.prototype._onTouchMove=function(t){var e=t;return function(t){if(e.vars.zoomVisible){t.preventDefault();var o=0,i=0,s=t.touches[0].pageX-e.touchOffsetX,a=t.touches[0].pageY-e.touchOffsetY,n=e.zoomImg.maxX,r=e.zoomImg.maxY;0>a&&(o=r>a?r:t.touches[0].pageY-e.touchOffsetY),0>s&&(i=n>s?n:t.touches[0].pageX-e.touchOffsetX),e._updateElem(i,o)}}},a.prototype._setSupports=function(t,e){t.supports.opacity="undefined"!=typeof e.style.opacity,t.supports.transform="undefined"!=typeof e.style.transform,t.supports.webkitTransform="undefined"!=typeof e.style.webkitTransform},a.prototype._addCallbacks=function(t){return this.callbacks=t&&t.callbacks?t.callbacks:{},this},a.prototype._handleArguments=function(t){switch(t.length){case 2:this.opts={};break;case 3:"function"==typeof t[2]?this.callbacks.init=t[2]:this.opts=t[2];break;case 4:this.opts=t[2],this.callbacks.init=t[3]}return this},a.prototype._cb=function(t,e){"function"==typeof this.callbacks[t]&&this.callbacks[t].call(this,e)},a.prototype._initElements=function(t,e){return this.$wrapper="string"==typeof t?document.querySelector(t):t,this.$wrapper&&(this.$baseImage="string"==typeof e?this.$wrapper.querySelector(e):e),this.$wrapper&&this.$baseImage?(this.$wrapper.style.cssText=o.wrapper.join(";"),this.$baseImage.style.cssText=o.baseImg.join(";"),this._cb("init",this),this):this._cb("init",i["no elements"])},a.prototype._updateElem=function(t,e){t=Math.ceil(t),e=Math.ceil(e);var o=this.vars.supports,i=this._translateText(t,e);if(this.$zoomImage){if(this._cb("update zoom position",[t,e]),o.webkitTransform)return this.$zoomImage.style.webkitTransform=i;if(o.transform)return this.$zoomImage.style.transform=i;this.$zoomImage.style.left=t+"px",this.$zoomImage.style.top=e+"px"}},a.prototype._translateText=function(t,e){var o="translate3d(%xpx, %ypx, 0)";return o.replace("%x",t).replace("%y",e)},a.prototype.showZoomed=function(){var t=this.vars.supports,e=this.$zoomImage;return e&&(t.opacity?e.style.opacity="1":e.style.display="block",this.vars.zoomVisible=!0,this._cb("show zoom",e)),this},a.prototype.hideZoomed=function(){var t=this.vars.supports,e=this.$zoomImage;return e&&(t.opacity?e.style.opacity="0":e.style.display="none",this.vars.zoomVisible=!1,this._cb("hide zoom",e)),this},a.prototype.setBaseImage=function(t,o){this.vars.baseImageLoading=!0,this._cb("base image loading",t);var i=this,s=function(){i.vars.baseImageLoading=!1,i.baseImg=new e(i.$baseImage),i._updateMapping(i.$baseImage),i._cb("base image loaded",i.$baseImage),"function"==typeof o&&o(i.$baseImage)};return this.$baseImage.src.indexOf(t)>-1?s():this.$baseImage.src=t,this.$baseImage.onload=s,this},a.prototype.setZoomImage=function(t,e){this.vars.imageLoading=!0,this._cb("zoom image loading",t);var i=this._onLoadCallback(e);return this.$zoomImage?this.$zoomImage.src.indexOf(t)>0?i():this.$zoomImage.src=t:(this.$zoomImage=document.createElement("IMG"),this.$zoomImage.className="zoom-image",this.$zoomImage.src=t,this.$zoomImage.style.cssText=o.zoomImg.join(";"),this.$wrapper.appendChild(this.$zoomImage)),this.$zoomImage.onload=i,this},a.prototype.refresh=function(){return this._updateMapping(this.$baseImage),this};"function"==typeof define&&define.amd?define(function(){return a}):"undefined"!=typeof module&&module.exports?module.exports=a:t.Closeup=a}(window,Norman);